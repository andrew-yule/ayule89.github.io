<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Budweiser - Beer and Brewery Analysis</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Andrew Yule</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="About_Me.html">About Me</a>
</li>
<li>
  <a href="Case_Study_1.html">Case Study 1</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Budweiser - Beer and Brewery Analysis</h1>

</div>


<p>To view an interactive shinny app of a portion of this analysis
please visit this <a
href="https://ayule89.shinyapps.io/Case_Study_1_Shinny_App/">here</a>.</p>
<pre class="r"><code>library(tidyverse)
library(maps)
library(gridExtra)
library(class)
library(caret)
library(e1071)

theme_set(theme_bw())</code></pre>
<div id="exploratory-data-analysis-eda" class="section level1">
<h1>Exploratory data analysis (EDA)</h1>
<div id="data-import" class="section level2">
<h2>Data import</h2>
<div id="import-the-beers-and-breweries-data-sets-and-do-minor-cleanup"
class="section level3">
<h3>Import the beers and breweries data sets and do minor cleanup</h3>
<pre class="r"><code>beers = read_csv(&quot;/Users/andrewyule/Dropbox/Personal/SMU MSDS/03 - Doing Data Science/SMU_DDS_CaseStudy1/Data/Beers.csv&quot;)
breweries = read_csv(&quot;/Users/andrewyule/Dropbox/Personal/SMU MSDS/03 - Doing Data Science/SMU_DDS_CaseStudy1/Data/Breweries.csv&quot;)

# Change ABV from fraction to percent
beers = beers |&gt;
  mutate(ABV = ABV * 100)</code></pre>
</div>
</div>
<div id="analysis-questions" class="section level2">
<h2>Analysis questions</h2>
<div id="how-many-breweries-are-present-in-each-state"
class="section level3">
<h3>1. How many breweries are present in each state?</h3>
<p>In the data, Colorado was found to have the most number of breweries
from the data set (47), followed by California (39), Michigan (32),
Oregon (29), and Texas (28). The lowest counted number of breweries was
1, which was found in Washington DC, North Dakota, South Dakota and West
Virigina.</p>
<pre class="r"><code>breweryCount = breweries |&gt; count(State)
stateAbbreviations = tibble(abb = state.abb, name = tolower(state.name))
breweryCount = left_join(breweryCount, stateAbbreviations, by = c(&quot;State&quot; = &quot;abb&quot;))

states = as_tibble(map_data(&quot;state&quot;))
breweryCount = left_join(states, breweryCount, by = c(&quot;region&quot; = &quot;name&quot;))
ggplot(breweryCount, aes(x = long, y = lat, group = group))+
  geom_polygon(aes(fill = n))+
  geom_path() + 
  scale_fill_gradientn(colours = rev(heat.colors(10)), na.value = &quot;grey90&quot;) +
  coord_map() +
  labs(x = NULL, y = NULL) +
  theme_void()</code></pre>
<p><img src="Case_Study_1_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>What percentage of breweries do the top 5 states make up?</p>
<pre class="r"><code>sum(arrange(count(breweries, State), desc(n))[1:5, 2]) / sum(count(breweries, State)[, 2])</code></pre>
<pre><code>## [1] 0.3136201</code></pre>
</div>
<div
id="merge-the-beers-and-breweries-data-sets-to-create-a-single-data-set-containing-both-beer-information-as-well-as-brewery"
class="section level3">
<h3>2. Merge the beers and breweries data sets to create a single data
set containing both beer information as well as brewery</h3>
<p>The two datasets (beers and breweries) were merged using a left_join
across the columns “Brewery_ID” (for beers) and “Brew_ID” (for
breweries). The left join ensures that we only insert brewery
information where a matching beer is found.</p>
<pre class="r"><code>beers = left_join(beers, breweries, by = c(&quot;Brewery_id&quot; = &quot;Brew_ID&quot;)) |&gt;
  rename(Beer = Name.x) |&gt;
  rename(Brewery = Name.y)

beers |&gt; head(n = 6)</code></pre>
<pre><code>## # A tibble: 6 × 10
##   Beer           Beer_ID   ABV   IBU Brewery_id Style Ounces Brewery City  State
##   &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;
## 1 Pub Beer          1436   5      NA        409 Amer…     12 10 Bar… Bend  OR   
## 2 Devil&#39;s Cup       2265   6.6    NA        178 Amer…     12 18th S… Gary  IN   
## 3 Rise of the P…    2264   7.1    NA        178 Amer…     12 18th S… Gary  IN   
## 4 Sinister          2263   9      NA        178 Amer…     12 18th S… Gary  IN   
## 5 Sex and Candy     2262   7.5    NA        178 Amer…     12 18th S… Gary  IN   
## 6 Black Exodus      2261   7.7    NA        178 Oatm…     12 18th S… Gary  IN</code></pre>
<pre class="r"><code>beers |&gt; tail(n = 6)</code></pre>
<pre><code>## # A tibble: 6 × 10
##   Beer           Beer_ID   ABV   IBU Brewery_id Style Ounces Brewery City  State
##   &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;
## 1 Rocky Mountai…    1035   7.5    NA        425 Amer…     12 Wynkoo… Denv… CO   
## 2 Belgorado          928   6.7    45        425 Belg…     12 Wynkoo… Denv… CO   
## 3 Rail Yard Ale      807   5.2    NA        425 Amer…     12 Wynkoo… Denv… CO   
## 4 B3K Black Lag…     620   5.5    NA        425 Schw…     12 Wynkoo… Denv… CO   
## 5 Silverback Pa…     145   5.5    40        425 Amer…     12 Wynkoo… Denv… CO   
## 6 Rail Yard Ale…      84   5.2    NA        425 Amer…     12 Wynkoo… Denv… CO</code></pre>
</div>
<div id="address-the-missing-values-in-each-column."
class="section level3">
<h3>3. Address the missing values in each column.</h3>
<p>The only columns from the data set containing missing entries are ABV
(alcohol by volume), IBU (international bitterness units), and Style.
The highest number of missing values was found for the IBU variable (42%
of values are missing). The high amount of missing values for IBU should
be considered in any further analysis involving this variable.</p>
<pre class="r"><code>(colSums(is.na(beers))/dim(beers)[1])*100</code></pre>
<pre><code>##       Beer    Beer_ID        ABV        IBU Brewery_id      Style     Ounces 
##  0.0000000  0.0000000  2.5726141 41.7012448  0.0000000  0.2074689  0.0000000 
##    Brewery       City      State 
##  0.0000000  0.0000000  0.0000000</code></pre>
</div>
<div
id="compute-the-median-alcohol-content-and-international-bitterness-unit-for-each-state.-plot-a-bar-chart-to-compare.-which-state-has-the-maximum-alcoholic-abv-beer-which-state-has-the-most-bitter-ibu-beer"
class="section level3">
<h3>4. / 5. Compute the median alcohol content and international
bitterness unit for each state. Plot a bar chart to compare. Which state
has the maximum alcoholic (ABV) beer? Which state has the most bitter
(IBU) beer?</h3>
<p>The median alcohol by volume (ABV) across the states varies between
0.04 (Utah) and 0.0625 (Washington DC &amp; Kentucky). The median
international bitterness unit (IBU) varies between 19 (Wisconsin) and 61
(Maine).</p>
<pre class="r"><code>medianABV = beers |&gt;
  filter(!is.na(ABV)) |&gt;
  group_by(State) |&gt;
  summarize(ABV = median(ABV))

medianIBU = beers |&gt;
  filter(!is.na(IBU)) |&gt;
  group_by(State) |&gt;
  summarize(IBU = median(IBU))

p1 = medianABV |&gt;
  ggplot(aes(x = reorder(State, ABV), y = ABV)) +
  geom_col(fill = &quot;#C80F2D&quot;) +
  labs(y = &quot;Median ABV&quot;, x = NULL, title = &quot;Median Alcohol by Volume (ABV) Across States&quot;) +
  theme(text=element_text(size=18))

p2 = medianIBU |&gt;
  ggplot(aes(x = reorder(State, IBU), y = IBU)) +
  geom_col(fill = &quot;#C80F2D&quot;) +
  labs(y = &quot;Median IBU&quot;, x = NULL, title = &quot;Median International Bitterness Unit (IBU) Across States&quot;) +
  theme(text=element_text(size=18))

grid.arrange(p1, p2)</code></pre>
<p><img src="Case_Study_1_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>beers |&gt;
  filter(!is.na(ABV)) |&gt;
  group_by(State) |&gt;
  summarize(MedianABV = median(ABV)) |&gt;
  left_join(stateAbbreviations, by = c(&quot;State&quot; = &quot;abb&quot;)) |&gt;
  left_join(states, y = _, by = c(&quot;region&quot; = &quot;name&quot;)) |&gt;
  ggplot(aes(x = long, y = lat, group = group)) + 
  geom_polygon(aes(fill = MedianABV)) +
  geom_path() + 
  scale_fill_gradientn(colours = rev(heat.colors(10)), na.value = &quot;grey90&quot;) +
  coord_map() +
  labs(x = NULL, y = NULL) +
  theme_void()</code></pre>
<p><img src="Case_Study_1_files/figure-html/unnamed-chunk-7-2.png" width="672" /></p>
<pre class="r"><code>beers |&gt;
  filter(!is.na(IBU)) |&gt;
  group_by(State) |&gt;
  summarize(MedianIBU = median(IBU)) |&gt;
  left_join(stateAbbreviations, by = c(&quot;State&quot; = &quot;abb&quot;)) |&gt;
  left_join(states, y = _, by = c(&quot;region&quot; = &quot;name&quot;)) |&gt;
  ggplot(aes(x = long, y = lat, group = group)) + 
  geom_polygon(aes(fill = MedianIBU)) +
  geom_path() + 
  scale_fill_gradientn(colours = rev(heat.colors(10)), na.value = &quot;grey90&quot;) +
  coord_map() +
  labs(x = NULL, y = NULL) +
  theme_void()</code></pre>
<p><img src="Case_Study_1_files/figure-html/unnamed-chunk-7-3.png" width="672" /></p>
<p>The absolute maximum ABV and IBU for any state</p>
<pre class="r"><code>slice_max(beers, ABV, n = 1)</code></pre>
<pre><code>## # A tibble: 1 × 10
##   Beer           Beer_ID   ABV   IBU Brewery_id Style Ounces Brewery City  State
##   &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;
## 1 Lee Hill Seri…    2565  12.8    NA         52 Quad…   19.2 Upslop… Boul… CO</code></pre>
<pre class="r"><code>slice_max(beers, IBU, n = 1)</code></pre>
<pre><code>## # A tibble: 1 × 10
##   Beer           Beer_ID   ABV   IBU Brewery_id Style Ounces Brewery City  State
##   &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;
## 1 Bitter Bitch …     980   8.2   138        375 Amer…     12 Astori… Asto… OR</code></pre>
</div>
<div
id="comment-on-the-summary-statistics-and-distribution-of-the-abv-variable."
class="section level3">
<h3>6. Comment on the summary statistics and distribution of the ABV
variable.</h3>
<p>Overall, the average ABV is around 0.059, with a minimum and maximum
reported value of 0.001 and 0.128 respectively. The distribution of ABV
is right skewed, meaning there are a few beers with very high alcohol
contents increasing the mean ABV compared to the median ABV.</p>
<pre class="r"><code>beers |&gt; 
  select(ABV) |&gt;
  summary()</code></pre>
<pre><code>##       ABV        
##  Min.   : 0.100  
##  1st Qu.: 5.000  
##  Median : 5.600  
##  Mean   : 5.977  
##  3rd Qu.: 6.700  
##  Max.   :12.800  
##  NA&#39;s   :62</code></pre>
<pre class="r"><code>beers |&gt; 
  ggplot(aes(x = ABV)) +
  geom_histogram(fill = &quot;#C80F2D&quot;) +
  labs(x = &quot;ABV (%)&quot;, y = &quot;Frequency&quot;, title = &quot;Distribution of ABV Values Across Beers&quot;) +
  theme(text=element_text(size=18))</code></pre>
<p><img src="Case_Study_1_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div
id="is-there-an-apparent-relationship-between-the-bitterness-of-the-beer-and-its-alcoholic-content-draw-a-scatter-plot.-make-your-best-judgment-of-a-relationship-and-explain-your-answer."
class="section level3">
<h3>7. Is there an apparent relationship between the bitterness of the
beer and its alcoholic content? Draw a scatter plot. Make your best
judgment of a relationship and EXPLAIN your answer.</h3>
<p>The scatterplot between IBU and ABV shows that there is a positive
correlation (0.67). This indicates that as IBU increases, it is expected
that ABV will increase as well.</p>
<pre class="r"><code>cor(beers[!is.na(beers$ABV) &amp; !is.na(beers$IBU),]$IBU, beers[!is.na(beers$ABV) &amp; !is.na(beers$IBU),]$ABV)</code></pre>
<pre><code>## [1] 0.6706215</code></pre>
<pre class="r"><code>beers |&gt;
  ggplot(aes(x = IBU, y = ABV)) +
  geom_point(color = &quot;#C80F2D&quot;) +
  geom_smooth(method = &quot;lm&quot;) +
  labs(x = &quot;IBU&quot;, y = &quot;ABV (%)&quot;, title = &quot;Relationship between IBU and ABV&quot;) +
  theme(text=element_text(size=18))</code></pre>
<p><img src="Case_Study_1_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div
id="investigate-the-difference-with-respect-to-ibu-and-abv-between-ipas-india-pale-ales-and-other-types-of-ale."
class="section level3">
<h3>8. Investigate the difference with respect to IBU and ABV between
IPAs (India Pale Ales) and other types of Ale.</h3>
<p>Visual evidence shows that there is distinct difference between IBU
and ABV values of IPA’s compared with Ales. In general, IPA have both
higher IBU and ABV.</p>
<pre class="r"><code>ipa = beers |&gt;
  filter(!is.na(ABV) &amp; !is.na(IBU)) |&gt;
  filter(str_detect(Style, &quot;(?:IPA|India.*Pale.*Ale)&quot;)) |&gt;
  select(ABV, IBU) |&gt;
  mutate(Style = &quot;IPA&quot;)

ales = beers |&gt;
  filter(!is.na(ABV) &amp; !is.na(IBU)) |&gt;
  anti_join(ipa) |&gt;
  filter(str_detect(Style, &quot;Ale&quot;)) |&gt;
  select(ABV, IBU) |&gt;
  mutate(Style = &quot;Ale&quot;)

ipaAndAles = full_join(ipa, ales)

# Visually show the relationship between IBU and ABV broken down between IPA&#39;s and Ales
ipaAndAles |&gt;
  ggplot(aes(x = IBU, y = ABV, color = Style)) +
  geom_point(size = 3) +
  labs(x = &quot;IBU&quot;, y = &quot;ABV (%)&quot;, title = &quot;Relationship Between IBU and ABV&quot;, subtitle = &quot;Broken Down By IPA&#39;s and Ale&#39;s&quot;) +
  theme(text=element_text(size=18))</code></pre>
<p><img src="Case_Study_1_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Based on the visual evidence above, classifying whether a beer is
either an IPA or Ale should be possible with high accuracy. To test this
theory, a k nearest neighbors classification (kNN) algorithm was used.
After cross validating using a 80/20 train/test split, an optimal k
value of 5 was found, which yielded an overall classification accuracy
of ~85% confirming that it is possible to distinguish between an IPA and
an Ale based on the beers IBU and ABV.</p>
<pre class="r"><code>set.seed(1234)
# Create a function to evaluate classification accuracy using an 80/20 split with varying values of k
evaluateKNN = function(k = 1){
  split = 0.8
  indicies = sample(1:dim(ipaAndAles)[1], ceiling(dim(ipaAndAles)[1] * split))
  train = ipaAndAles[indicies, ]
  test = ipaAndAles[-indicies, ]
  results = knn(train[, c(1, 2)], test[, c(1, 2)], ifelse(train[, 3] == &quot;IPA&quot;, 0, 1), k = k)
  confusionMatrix(as_factor(c(ifelse(test[, 3] == &quot;IPA&quot;, 0, 1))), results)$overall[1]
}

optimalK = crossing(set = 1:100, k = 1:100)
optimalK = optimalK |&gt;
  rowwise() |&gt;
  mutate(Accuracy = evaluateKNN(k))

# Plot the results of the cross validation showing possible achievable accuracy
optimalK |&gt;
  group_by(k) |&gt;
  summarize(Accuracy = mean(Accuracy)) |&gt;
  ggplot(aes(x = k, y = Accuracy)) + 
  geom_point(color = &quot;#C80F2D&quot;) +
  geom_path(color = &quot;#C80F2D&quot;) +
  labs(x = &quot;k&quot;, y = &quot;Average Accuracy&quot;, title = &quot;Classification Accuracy of IPA&#39;s and Ales&quot;, subtitle = &quot;kNN Classification Algorithm Used With Varying k Values&quot;) +
  theme(text=element_text(size=18))</code></pre>
<p><img src="Case_Study_1_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div
id="which-states-may-be-under-represented-by-the-number-of-breweries-and-would-thus-benefit-from-budweiser-investment"
class="section level3">
<h3>9. Which states may be under represented by the number of breweries
and would thus benefit from Budweiser investment?</h3>
<p>A visual of the population of each state ploted on a log-log scale
with the number of breweries along with a linear line of best fit allows
for a distinction between states that potentially have more saturated
number of breweries as compared to less. From this visual, it can be
seen that states like Georgia, New Jersey, Tennessee, Alabama, and South
Carolina are all potentially under represented in their brewery count
while still having high enough populations to make investment in more
breweries economical for Budweiser.</p>
<pre class="r"><code>statePopulations = read_csv(&quot;/Users/andrewyule/Dropbox/Personal/SMU MSDS/03 - Doing Data Science/SMU_DDS_CaseStudy1/Data/State_Populations.csv&quot;)

statesWithBreweriesAndPopulations = left_join(breweries, statePopulations, by = &quot;State&quot;) |&gt;
  group_by(State) |&gt;
  summarize(Breweries = n(), Population = Population) |&gt;
  filter(!duplicated(State, Breweries, Population))

statesWithBreweriesAndPopulations |&gt;
  ggplot(aes(x = Population, y = Breweries)) +
  geom_point(size = 3, color = &quot;#C80F2D&quot;) +
  geom_text(aes(label = State), nudge_y = 0.05, color = &quot;#C80F2D&quot;, size = 5) +
  geom_smooth(method = &quot;lm&quot;) +
  #scale_x_log10(labels = ~ format(.x, scientific = FALSE)) +
  scale_x_log10(labels = scales::comma) +
  scale_y_log10() +
  labs(x = &quot;State Population&quot;, y = &quot;Number of Breweries&quot;, title = &quot;Brewery Count with State Population&quot;) +
  theme(text=element_text(size=18))</code></pre>
<p><img src="Case_Study_1_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
